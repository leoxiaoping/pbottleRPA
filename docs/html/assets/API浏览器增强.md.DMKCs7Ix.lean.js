import{_ as r,c as p,a0 as e,j as t,o}from"./chunks/framework.DozuH5zb.js";const m=JSON.parse('{"title":"浏览器增强 - web应用","description":"","frontmatter":{},"headers":[],"relativePath":"API浏览器增强.md","filePath":"API浏览器增强.md","lastUpdated":1754552155000}'),l={name:"API浏览器增强.md"};function s(i,a,h,n,c,u){return o(),p("div",null,a[0]||(a[0]=[e('<h1 id="浏览器增强-web应用" tabindex="-1">浏览器增强 - web应用 <a class="header-anchor" href="#浏览器增强-web应用" aria-label="Permalink to &quot;浏览器增强 - web应用&quot;">​</a></h1><p><strong>⚠ 浏览器插件只是一种web浏览器页面操作的快捷操作方式，不是必须。按照小瓶RPA桌面应用的操作规则一样可以操作web浏览器应用。</strong></p><p>需要先安装小瓶RPA浏览器插件，安装方法查看：</p><p><a href="https://rpa.pbottle.com/a-13942.html" target="_blank" rel="noreferrer">https://rpa.pbottle.com/a-13942.html</a></p><p>基础调用方式： <code>pbottleRPA.browserCMD.xxx()</code></p><p>可以参考 “web增强“ 开头的demo示例。</p><h2 id="元素选择器" tabindex="-1">元素选择器 <a class="header-anchor" href="#元素选择器" aria-label="Permalink to &quot;元素选择器&quot;">​</a></h2><p>小瓶RPA web增强基本遵循已经被广泛使用 <strong>jQuery选择器</strong> 的设计规则，可以参考jquery的选择器文档。</p><p><a href="https://www.runoob.com/jquery/jquery-ref-selectors.html" target="_blank" rel="noreferrer">https://www.runoob.com/jquery/jquery-ref-selectors.html</a></p><p>相比 xpath 等方案优势：</p><ul><li>学习成本低，规则和浏览器的 document.querySelector 原生方法一致</li><li>兼容性强，支持虚拟DOM的前端框架，如：Vue React 等</li><li>支持功能丰富且强大的伪类方案，可以高级选择定位</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pbottleRPA.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">browserCMD_click</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;button:contains(登录帐号)&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="元素选择器测试工具" tabindex="-1">元素选择器测试工具 <a class="header-anchor" href="#元素选择器测试工具" aria-label="Permalink to &quot;元素选择器测试工具&quot;">​</a></h2><p>新版小瓶RPA增加了元素选择器测试功能，本功能旨在帮助用户在复杂网页中快速定位和选择html的元素。</p><p><img src="https://www.pbottle.com/static/upload/20250416/17447934102282.png" alt="web增强插件"></p><p><strong>V2025.2 新增选中元素背景闪烁功能，方便用户查看元素位置。</strong></p><p>快速复制元素选择器步骤：</p><ol><li>鼠标放到浏览器目标元素上，F12 或者 右键菜单“检查元素”</li><li>目标元素代码块上，右键弹出复制菜单</li><li>选择 复制selector 【复制选择器】</li></ol><p><img src="https://www.pbottle.com/static/upload/20250807/17545509544351.png" alt="小瓶RPA如何精准选择网页的元素"></p><h2 id="alert-警告框" tabindex="-1">alert 警告框 <a class="header-anchor" href="#alert-警告框" aria-label="Permalink to &quot;alert 警告框&quot;">​</a></h2><p>browserCMD_alert()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>警告框</p><p>@param {*} msg 显示文本内容</p><p>@returns 无</p><h2 id="url-获取-设置当前url" tabindex="-1">url 获取|设置当前url <a class="header-anchor" href="#url-获取-设置当前url" aria-label="Permalink to &quot;url 获取|设置当前url&quot;">​</a></h2><p>browserCMD_url()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>@param {string} urlStr 当前网页转向新网址，默认为空获取当前网址 【小瓶RPA浏览器增强插件V2023.8以上生效】</p><p>@returns {string} 返回当前浏览器的url网址 或者 ok</p><h2 id="click-点击" tabindex="-1">click 点击 <a class="header-anchor" href="#click-点击" aria-label="Permalink to &quot;click 点击&quot;">​</a></h2><p>browserCMD_click()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>模拟点击 参考 jQuery click() 方法，改为浏览器 native 的 click() 并自动获取焦点</p><p>@param {string} selector 元素选择器。如果选择多个元素，只触发第一个元素的click事件</p><p>@param {number} 点击类型 0:默认浏览器原生点击，1：阻止冒泡事件，只触发元素自身点击事件</p>',36),t("p",{string:""},"@returns",-1),e('<h2 id="closetab-关闭标签页" tabindex="-1">closeTab 关闭标签页 <a class="header-anchor" href="#closetab-关闭标签页" aria-label="Permalink to &quot;closeTab 关闭标签页&quot;">​</a></h2><p>browserCMD_closeTab(&#39;current&#39;|&#39;other&#39;) V2025.4 以上版本支持。</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>关闭浏览器标签页。打开新标签页用 pbottleRPA.openURL()</p><p>@param {string} 关闭类型 &#39;current&#39;:默认关闭当前标签页; &#39;other&#39;:关闭其他标签页</p><p>@returns {string} 正常返回 &#39;ok&#39;</p><h2 id="count-元素计数" tabindex="-1">count 元素计数 <a class="header-anchor" href="#count-元素计数" aria-label="Permalink to &quot;count 元素计数&quot;">​</a></h2><p>browserCMD_count()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>元素数量 参考 jQuery 选择器</p><p>@param {string} selector 元素选择器</p><p>@returns {number} 返回选择元素的数量，最优的选择结果是1</p><h2 id="hide-隐藏元素" tabindex="-1">hide 隐藏元素 <a class="header-anchor" href="#hide-隐藏元素" aria-label="Permalink to &quot;hide 隐藏元素&quot;">​</a></h2><p>browserCMD_hide()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>隐藏 参考 jQuery hide() 方法</p><p>@param {*} selector 元素选择器</p><p>@returns</p><h2 id="show-显示元素" tabindex="-1">show 显示元素 <a class="header-anchor" href="#show-显示元素" aria-label="Permalink to &quot;show 显示元素&quot;">​</a></h2><p>browserCMD_show()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>显示 参考 jQuery show() 方法</p><p>@param {*} selector 元素选择器</p><p>@returns</p><h2 id="offset-获取元素位置" tabindex="-1">offset 获取元素位置 <a class="header-anchor" href="#offset-获取元素位置" aria-label="Permalink to &quot;offset 获取元素位置&quot;">​</a></h2><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展 2024.0 以上版本生效</p><p>获取元素定位，相对浏览器文档左上角 参考 jQuery offset() 方法</p><p>@param {string} selector 元素选择器</p><p>@returns {} 返回 json:<code>{&quot;top&quot;:100,&quot;left&quot;:100}</code></p><h2 id="remove-移除元素" tabindex="-1">remove 移除元素 <a class="header-anchor" href="#remove-移除元素" aria-label="Permalink to &quot;remove 移除元素&quot;">​</a></h2><p>browserCMD_remove()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>移除元素 参考 jQuery remove() 方法</p><p>@param {*} selector 元素选择器</p><h2 id="text-获取-设置文本" tabindex="-1">text 获取|设置文本 <a class="header-anchor" href="#text-获取-设置文本" aria-label="Permalink to &quot;text 获取|设置文本&quot;">​</a></h2><p>browserCMD_text</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或者设置文本 参考 jQuery text() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} content</p><p>@returns</p><h2 id="html-设置-获取代码" tabindex="-1">html 设置|获取代码 <a class="header-anchor" href="#html-设置-获取代码" aria-label="Permalink to &quot;html 设置|获取代码&quot;">​</a></h2><p>browserCMD_html()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或者设置html 参考 jQuery html() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} content</p><p>@returns</p><h2 id="val-获取-设置值" tabindex="-1">val 获取|设置值 <a class="header-anchor" href="#val-获取-设置值" aria-label="Permalink to &quot;val 获取|设置值&quot;">​</a></h2><p>browserCMD_val()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或设置值 input select等 参考 jQuery val() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} content</p><p>@returns</p><h2 id="cookie-获取-设置-小存储" tabindex="-1">cookie 获取|设置 小存储 <a class="header-anchor" href="#cookie-获取-设置-小存储" aria-label="Permalink to &quot;cookie 获取|设置 小存储&quot;">​</a></h2><p>browserCMD_cookie()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或设置当前站点的 cookie</p><p>@param {*} cName cookie 名称</p><p>@param {*} cValue cookie 值 留空为获取cookie的值</p><p>@param {*} expDays cookie 过期时间，单位：天, 留空为会话cookie</p><p>@returns 返回 cookie的值</p><h2 id="css-获取-设置样式" tabindex="-1">css 获取|设置样式 <a class="header-anchor" href="#css-获取-设置样式" aria-label="Permalink to &quot;css 获取|设置样式&quot;">​</a></h2><p>browserCMD_css()</p><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或设置css样式 参考 jQuery css() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} propertyname</p><p>@param {*} value</p><p>@returns</p><h2 id="attr-获取-设置属性" tabindex="-1">attr 获取|设置属性 <a class="header-anchor" href="#attr-获取-设置属性" aria-label="Permalink to &quot;attr 获取|设置属性&quot;">​</a></h2><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或设置attr样式 参考 jQuery attr() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} 属性名</p><p>@param {*} value</p><h2 id="prop-获取-设置prop" tabindex="-1">prop 获取|设置prop <a class="header-anchor" href="#prop-获取-设置prop" aria-label="Permalink to &quot;prop 获取|设置prop&quot;">​</a></h2><p>浏览器增强命令 需要安装小瓶RPA的浏览器拓展</p><p>获取或设置prop样式 参考 jQuery prop() 方法</p><p>@param {*} selector 元素选择器</p><p>@param {*} 属性名</p><p>@param {*} value</p><h2 id="批量采集获取网页内容" tabindex="-1">批量采集获取网页内容 <a class="header-anchor" href="#批量采集获取网页内容" aria-label="Permalink to &quot;批量采集获取网页内容&quot;">​</a></h2><p>当选择器结果为多个元素时候，会一次性返回所有内容，内容格式为：JSON数组。 注意：V2025.3 以上版本支持。</p><p>批量采集获取网页内容目前支持方法：</p><ul><li><p>text()</p></li><li><p>html()</p></li><li><p>val()</p></li><li><p>attr()</p><p>参考示例：WEB增强-数据批量爬取演示.js</p></li></ul>',87)]))}const b=r(l,[["render",s]]);export{m as __pageData,b as default};
